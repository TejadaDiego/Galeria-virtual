<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Iniciar sesi칩n</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
body {
  background: linear-gradient(135deg, #7f00ff, #e100ff);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
  font-family: 'Poppins';
}

.card {
  background: rgba(255,255,255,0.12);
  padding: 30px;
  width: 350px;
  border-radius: 20px;
  backdrop-filter: blur(10px);
}

button {
  width: 100%;
  padding: 12px;
  background: #4A00E0;
  color: #fff;
  border: none;
  border-radius: 10px;
  font-weight: bold;
}
</style>

</head>
<body>

<div class="card">
  <h2>Iniciar sesi칩n</h2>

  <form id="formLogin">
    <input type="email" name="email" required placeholder="Correo" style="width:100%; padding:12px; border-radius:10px; margin-top:10px;">
    <input type="password" name="password" required placeholder="Contrase침a" style="width:100%; padding:12px; border-radius:10px; margin-top:10px;">
    <button>Entrar</button>
  </form>

  <a href="registro.html" style="color:white;">Crear cuenta</a>
</div>

<script>
document.getElementById("formLogin").addEventListener("submit", async(e)=>{
  e.preventDefault();
  
  const f = new FormData(e.target);

  const res = await fetch("Php/login.php", {
    method:"POST",
    body:f
  });

  let data = null;

  try {
    data = await res.json();
  } catch (err) {
    alert("Error al procesar la respuesta del servidor");
    return;
  }

  // Errores desde PHP
  if (!data.success) {
    alert(data.error);
    return;
  }

  // 游댠 Guardamos TODO el usuario
  localStorage.setItem("usuario", JSON.stringify(data.usuario));

  // 游댠 Guardamos campos individuales para acceso r치pido
  localStorage.setItem("nombreUsuario", data.usuario.nombre);
  localStorage.setItem("correoUsuario", f.get("email"));

  // Redirigir
  window.location.href = "inicio.html";
});
</script>

</body>
</html>
