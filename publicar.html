<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Publicar Trabajo - Galería Virtual</title>

  <link rel="stylesheet" href="Estilos/publicar.css">
  <link rel="stylesheet" href="Estilos/estilo.css">
  <link rel="stylesheet" href="Estilos/premium.css">

  <style>
    body { background:#0d0b1f; margin:0; font-family:Arial; }

    /* NAV */
    .navbar {
      width:100%;
      padding:20px;
      background:#0d0b1f;
      display:flex;
      justify-content:space-between;
      align-items:center;
      box-shadow:0 0 10px rgba(255,255,255,0.1);
      position:sticky;
      top:0;
      z-index:20;
    }

    .navbar-logo{
      font-size:22px;
      color:white;
      font-weight:bold;
    }

    .navbar-links{
      display:flex;
      gap:25px;
      align-items:center;
    }

    .navbar-links a{
      color:white;
      text-decoration:none;
      font-size:17px;
      transition:0.3s;
    }

    .navbar-links a:hover{
      color:#b34cff;
    }

    .navbar-links a.active{
      color:#b34cff;
      font-weight:bold;
    }

    /* FOTO DEL USUARIO */
    .navbar-user-box img{
      width:45px;
      height:45px;
      border-radius:50%;
      border:2px solid #a569ff;
      object-fit:cover;
      cursor:pointer;
    }
  </style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar">
  <div class="navbar-logo">Galería Virtual</div>

  <div class="navbar-links">
    <a href="inicio.html">Inicio</a>
    <a href="Sobre_nosotros.html">Nosotros</a>
    <a href="Contenido.html">Contenido</a>
    <a href="publicar.html" class="active">Publicar +</a>

    <!-- BOTÓN LOGIN (solo se muestra sin sesión) -->
    <li id="btnLoginHeader" style="display:none;">
      <a href="login.html">Iniciar Sesión</a>
    </li>

    <!-- AQUI sesion-global.js insertará foto + nombre -->
    <div id="navbarUserBox"></div>
  </div>
</nav>

<!-- FORMULARIO PUBLICAR -->
<div class="form-container">
  <h2>Publicar nuevo trabajo</h2>

  <form id="formPublicar" enctype="multipart/form-data">

    <label for="titulo">Nombre del trabajo:</label>
    <input type="text" id="titulo" name="titulo" required>

    <label for="descripcion">Descripción:</label>
    <textarea id="descripcion" name="descripcion" rows="4" required></textarea>

    <label for="precio">Precio (S/):</label>
    <input type="number" id="precio" name="precio" step="0.01" required>

    <label for="imagen">Imagen del trabajo:</label>
    <input type="file" id="imagen" name="imagen" accept="image/*" required>

    <img id="previewImg" style="display:none; width:200px; border-radius:10px; margin-top:10px;">

    <button type="submit">Subir trabajo</button>
  </form>
</div>

<!-- SCRIPTS REALES -->
<script src="Scripts/publicar.js"></script>
<script src="Scripts/sesion-global.js"></script>

<script>
/* --- CONTROL DE VISIBILIDAD LOGIN / USUARIO --- */
/* sesion-global.js ya trae userData desde loginhandler.php */

document.addEventListener("DOMContentLoaded", () => {
    const storedUser = localStorage.getItem("userData");
    const btnLogin = document.getElementById("btnLoginHeader");
    const userBox = document.getElementById("navbarUserBox");

    if (!storedUser) {
        // NO HAY USUARIO - Mostrar botón login
        btnLogin.style.display = "block";
        userBox.innerHTML = "";
        return;
    }

    // SI HAY USUARIO
    let u = JSON.parse(storedUser);

    btnLogin.style.display = "none";

    userBox.innerHTML = `
      <div class="navbar-user-box" style="display:flex; align-items:center; gap:10px;">
        <img src="uploads/${u.foto}" alt="Usuario">
        <span style="color:#fff; font-size:16px;">${u.nombre}</span>
      </div>
    `;
});
</script>

</body>
</html>
