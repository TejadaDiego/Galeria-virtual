<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Mi Cuenta</title>
    <link rel="stylesheet" href="Estilos/cuenta.css">
</head>

<body>

    <div class="cuenta-container">

        <h1>Mi Cuenta</h1>

        <!-- FOTO -->
        <img id="fotoPerfil" class="foto-perfil" src="Img/default.png">

        <button id="btnCambiarFoto">Cambiar foto</button>
        <input type="file" id="nuevaFoto" accept="image/*" style="display:none">

        <!-- NOMBRE -->
        <div class="input-group">
            <label>Nombre:</label>
            <input type="text" id="nuevoNombre">
        </div>

        <!-- CORREO (solo lectura) -->
        <div class="input-group">
            <label>Correo:</label>
            <input type="text" id="correoUsuario" readonly>
        </div>

        <button id="guardarCambios" class="btn-guardar">Guardar cambios</button>

        <button class="btn-salir" onclick="cerrarSesion()">Cerrar sesión</button>

    </div>


    <script>
        // Cargar datos del usuario
        const user = JSON.parse(localStorage.getItem("usuarioActivo"));

        if (!user) location.href = "login.html";

        // Mostrar datos actuales
        document.getElementById("fotoPerfil").src = user.foto || "Img/default.png";
        document.getElementById("nuevoNombre").value = user.nombre;
        document.getElementById("correoUsuario").value = user.correo;

        // Cambiar foto
        document.getElementById("btnCambiarFoto").addEventListener("click", () => {
            document.getElementById("nuevaFoto").click();
        });

        document.getElementById("nuevaFoto").addEventListener("change", function () {
            const file = this.files[0];
            if (!file) return;

            const reader = new FileReader();

            reader.onload = function (e) {
                document.getElementById("fotoPerfil").src = e.target.result;
                user.foto = e.target.result;

                localStorage.setItem("usuarioActivo", JSON.stringify(user));
            };

            reader.readAsDataURL(file);
        });

        // Guardar nuevo nombre
        document.getElementById("guardarCambios").addEventListener("click", () => {
            const nuevoNombre = document.getElementById("nuevoNombre").value.trim();

            if (nuevoNombre.length < 3) {
                alert("El nombre debe tener al menos 3 caracteres.");
                return;
            }

            user.nombre = nuevoNombre;

            localStorage.setItem("usuarioActivo", JSON.stringify(user));

            alert("Cambios guardados correctamente");
        });

        // Cerrar sesión
        function cerrarSesion() {
            localStorage.removeItem("usuarioActivo");
            location.href = "login.html";
        }
    </script>

</body>
</html>
